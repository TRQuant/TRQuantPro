---
title: "5.3 è‚¡ç¥¨è¯„åˆ†"
description: "è¯¦ç»†ä»‹ç»å€™é€‰æ± æ„å»ºæ¨¡å—çš„è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿï¼ŒåŒ…æ‹¬å¤šå› å­è¯„åˆ†ã€ç»¼åˆè¯„åˆ†è®¡ç®—å’Œè¯„åˆ†æ’åºæ–¹æ³•"
lang: "zh-CN"
layout: "/src/layouts/HandbookLayout.astro"
currentBook: "ashare-book6"
updateDate: "2025-12-12"
---

# ğŸ“ˆ 5.3 è‚¡ç¥¨è¯„åˆ†

> **æ ¸å¿ƒæ‘˜è¦ï¼š**
> 
> æœ¬èŠ‚ç³»ç»Ÿä»‹ç»å€™é€‰æ± æ„å»ºæ¨¡å—çš„è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿï¼Œé€šè¿‡æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€åŸºæœ¬é¢ã€æƒ…ç»ªé¢å››ä¸ªç»´åº¦å¯¹å€™é€‰è‚¡ç¥¨è¿›è¡Œå¤šå› å­è¯„åˆ†ï¼Œå¹¶è®¡ç®—ç»¼åˆè¯„åˆ†ã€‚é€šè¿‡ç†è§£å„ç»´åº¦è¯„åˆ†æ–¹æ³•ã€ç»¼åˆè¯„åˆ†è®¡ç®—å’Œè¯„åˆ†æ’åºæ–¹æ³•ï¼Œå¸®åŠ©å¼€å‘è€…æŒæ¡å¦‚ä½•æ„å»ºå…¨é¢çš„è‚¡ç¥¨è¯„åˆ†ä½“ç³»ï¼Œä¸ºå€™é€‰æ± æ’åºå’Œç­›é€‰æä¾›å‡†ç¡®ä¾æ®ã€‚

è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿå¯¹å€™é€‰è‚¡ç¥¨è¿›è¡Œå¤šå› å­è¯„åˆ†ï¼Œä¸ºå€™é€‰æ± æ’åºå’Œç­›é€‰æä¾›ä¾æ®ã€‚

## ğŸ“‹ ç« èŠ‚æ¦‚è§ˆ

<script>
function scrollToSection(sectionId) {
  const element = document.getElementById(sectionId);
  if (element) {
    const headerOffset = 100;
    const elementPosition = element.getBoundingClientRect().top;
    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
    window.scrollTo({
      top: offsetPosition,
      behavior: 'smooth'
    });
  }
}
</script>

<div class="section-overview">
  <div class="section-item" onclick="scrollToSection('section-5-3-1')">
    <h4>ğŸ“Š 5.3.1 æŠ€æœ¯é¢è¯„åˆ†</h4>
    <p>ä»·æ ¼è¶‹åŠ¿ã€æˆäº¤é‡ã€æŠ€æœ¯æŒ‡æ ‡ã€çªç ´ä¿¡å·ç­‰å› å­çš„è¯„åˆ†æ–¹æ³•</p>
  </div>
  <div class="section-item" onclick="scrollToSection('section-5-3-2')">
    <h4>ğŸ’° 5.3.2 èµ„é‡‘é¢è¯„åˆ†</h4>
    <p>ä¸»åŠ›èµ„é‡‘ã€åŒ—å‘èµ„é‡‘ã€é¾™è™æ¦œã€æ¢æ‰‹ç‡ç­‰å› å­çš„è¯„åˆ†æ–¹æ³•</p>
  </div>
  <div class="section-item" onclick="scrollToSection('section-5-3-3')">
    <h4>ğŸ’¼ 5.3.3 åŸºæœ¬é¢è¯„åˆ†</h4>
    <p>ç›ˆåˆ©èƒ½åŠ›ã€æˆé•¿æ€§ã€ä¼°å€¼æ°´å¹³ã€è´¢åŠ¡å¥åº·ç­‰å› å­çš„è¯„åˆ†æ–¹æ³•</p>
  </div>
  <div class="section-item" onclick="scrollToSection('section-5-3-4')">
    <h4>ğŸ˜Š 5.3.4 æƒ…ç»ªé¢è¯„åˆ†</h4>
    <p>æ¶¨è·Œåœã€é¾™è™æ¦œã€å¸‚åœºæƒ…ç»ªç­‰å› å­çš„è¯„åˆ†æ–¹æ³•</p>
  </div>
  <div class="section-item" onclick="scrollToSection('section-5-3-5')">
    <h4>ğŸ”¢ 5.3.5 ç»¼åˆè¯„åˆ†è®¡ç®—</h4>
    <p>åŠ æƒå¹³å‡è®¡ç®—ã€æƒé‡é…ç½®ã€ä¸»çº¿çƒ­åº¦èåˆ</p>
  </div>
  <div class="section-item" onclick="scrollToSection('section-5-3-6')">
    <h4>ğŸ“Š 5.3.6 è¯„åˆ†æ’åº</h4>
    <p>æŒ‰ç»¼åˆå¾—åˆ†æ’åºã€æŒ‰å› å­å¾—åˆ†æ’åºã€å¤šç»´åº¦æ’åº</p>
  </div>
</div>

## ğŸ¯ å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬èŠ‚å­¦ä¹ ï¼Œæ‚¨å°†èƒ½å¤Ÿï¼š

- **ç†è§£å¤šå› å­è¯„åˆ†è®¾è®¡**ï¼šæŒæ¡æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€åŸºæœ¬é¢ã€æƒ…ç»ªé¢å››ä¸ªç»´åº¦çš„è¯„åˆ†åŸç†
- **å®ç°å„ç»´åº¦è¯„åˆ†**ï¼šç†è§£å„ç»´åº¦ç‹¬ç«‹è¯„åˆ†çš„å®ç°ç»†èŠ‚å’Œä»£ç é€»è¾‘
- **æŒæ¡ç»¼åˆè¯„åˆ†è®¡ç®—**ï¼šç†è§£åŠ æƒå¹³å‡è®¡ç®—å’Œæƒé‡é…ç½®æ–¹æ³•
- **åº”ç”¨è¯„åˆ†æ’åº**ï¼šæŒæ¡è¯„åˆ†ç»“æœåœ¨å€™é€‰æ± æ’åºå’Œç­›é€‰ä¸­çš„åº”ç”¨

## ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

### æ¨¡å—å®šä½

- **å·¥ä½œæµä½ç½®**ï¼šæ­¥éª¤4 - ğŸ“¦ å€™é€‰æ± æ„å»º
- **æ ¸å¿ƒèŒè´£**ï¼šå¤šå› å­è¯„åˆ†ã€ç»¼åˆè¯„åˆ†è®¡ç®—ã€è¯„åˆ†æ’åº
- **æœåŠ¡å¯¹è±¡**ï¼šå€™é€‰æ± æ„å»ºå™¨ã€ç­–ç•¥ç”Ÿæˆ

### è¯„åˆ†è®¾è®¡åŸåˆ™

è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿéµå¾ªä»¥ä¸‹è®¾è®¡åŸåˆ™ï¼š

1. **å¤šç»´åº¦è¯„ä¼°**ï¼šè¦†ç›–æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€åŸºæœ¬é¢ã€æƒ…ç»ªé¢å››ä¸ªç»´åº¦ï¼Œå…¨é¢è¯„ä¼°è‚¡ç¥¨è´¨é‡
2. **å› å­ç‹¬ç«‹æ€§**ï¼šæ¯ä¸ªå› å­ç‹¬ç«‹è¯„åˆ†ï¼Œé¿å…å› å­é—´ç›¸äº’å½±å“
3. **æƒé‡å¯é…ç½®**ï¼šæ”¯æŒæ ¹æ®å¸‚åœºç¯å¢ƒåŠ¨æ€è°ƒæ•´å„ç»´åº¦æƒé‡
4. **ä¸»çº¿èåˆ**ï¼šç»“åˆä¸»çº¿çƒ­åº¦ï¼Œæå‡ä¸»çº¿ç›¸å…³è‚¡ç¥¨çš„è¯„åˆ†
5. **å¯è§£é‡Šæ€§**ï¼šæ¯ä¸ªå› å­çš„è¯„åˆ†æ–¹æ³•æ¸…æ™°é€æ˜ï¼Œä¾¿äºç†è§£å’Œè°ƒè¯•

<h2 id="section-5-3-1">ğŸ“Š 5.3.1 æŠ€æœ¯é¢è¯„åˆ†</h2>

æŠ€æœ¯é¢è¯„åˆ†é€šè¿‡åˆ†æä»·æ ¼è¶‹åŠ¿ã€æˆäº¤é‡ã€æŠ€æœ¯æŒ‡æ ‡ã€çªç ´ä¿¡å·ç­‰ï¼Œè¯„ä¼°è‚¡ç¥¨çš„æŠ€æœ¯é¢å¼ºå¼±ã€‚

### è¯„åˆ†å› å­

æŠ€æœ¯é¢è¯„åˆ†åŒ…æ‹¬ä»¥ä¸‹å› å­ï¼š

1. **ä»·æ ¼è¶‹åŠ¿**ï¼ˆ40%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€AKShare
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºä»·æ ¼åŠ¨é‡ã€è¶‹åŠ¿å¼ºåº¦

2. **æˆäº¤é‡**ï¼ˆ30%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€AKShare
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºæˆäº¤é‡æ”¾å¤§ã€é‡ä»·é…åˆ

3. **æŠ€æœ¯æŒ‡æ ‡**ï¼ˆ20%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šæŠ€æœ¯åˆ†æè®¡ç®—
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºMACDã€RSIã€KDJç­‰æŒ‡æ ‡

4. **çªç ´ä¿¡å·**ï¼ˆ10%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šæŠ€æœ¯åˆ†æè®¡ç®—
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºå‡çº¿çªç ´ã€ä»·æ ¼çªç ´

### è¯„åˆ†æ–¹æ³•å®ç°

```python
def score_technical_dimension(
    stock_code: str,
    price_data: pd.DataFrame,
    volume_data: pd.DataFrame,
    date: str
) -> float:
    """
    æŠ€æœ¯é¢è¯„åˆ†
    
    Args:
        stock_code: è‚¡ç¥¨ä»£ç 
        price_data: ä»·æ ¼æ•°æ®ï¼ˆåŒ…å«open, high, low, closeï¼‰
        volume_data: æˆäº¤é‡æ•°æ®
        date: è¯„åˆ†æ—¥æœŸ
    
    Returns:
        æŠ€æœ¯é¢è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
    """
    score = 0.0
    
    # 1. ä»·æ ¼è¶‹åŠ¿è¯„åˆ†ï¼ˆ0-40åˆ†ï¼‰
    # è®¡ç®—ä»·æ ¼åŠ¨é‡ï¼ˆ20æ—¥æ”¶ç›Šç‡ï¼‰
    returns_20d = (price_data['close'].iloc[-1] / price_data['close'].iloc[-21] - 1) * 100
    
    # è®¡ç®—è¶‹åŠ¿å¼ºåº¦ï¼ˆå‡çº¿æ–œç‡ï¼‰
    ma20 = price_data['close'].rolling(20).mean()
    ma60 = price_data['close'].rolling(60).mean()
    trend_strength = (ma20.iloc[-1] - ma20.iloc[-20]) / ma20.iloc[-20] * 100
    
    # ä»·æ ¼è¶‹åŠ¿è¯„åˆ†
    if returns_20d > 20 and trend_strength > 5:
        trend_score = 40
    elif returns_20d > 10 and trend_strength > 2:
        trend_score = 35
    elif returns_20d > 5 and trend_strength > 0:
        trend_score = 30
    elif returns_20d > 0:
        trend_score = 25
    else:
        trend_score = max(0, 20 + returns_20d * 0.5)
    
    # 2. æˆäº¤é‡è¯„åˆ†ï¼ˆ0-30åˆ†ï¼‰
    # è®¡ç®—æˆäº¤é‡æ”¾å¤§å€æ•°
    avg_volume_20d = volume_data['volume'].rolling(20).mean().iloc[-1]
    current_volume = volume_data['volume'].iloc[-1]
    volume_ratio = current_volume / avg_volume_20d if avg_volume_20d > 0 else 1
    
    # æˆäº¤é‡è¯„åˆ†
    if volume_ratio > 3:
        volume_score = 30
    elif volume_ratio > 2:
        volume_score = 25
    elif volume_ratio > 1.5:
        volume_score = 20
    elif volume_ratio > 1:
        volume_score = 15
    else:
        volume_score = max(0, 10 + (volume_ratio - 0.5) * 10)
    
    # 3. æŠ€æœ¯æŒ‡æ ‡è¯„åˆ†ï¼ˆ0-20åˆ†ï¼‰
    # è®¡ç®—MACDã€RSIã€KDJç­‰æŒ‡æ ‡
    macd_signal = calculate_macd_signal(price_data)
    rsi_value = calculate_rsi(price_data, period=14)
    kdj_signal = calculate_kdj_signal(price_data)
    
    # æŠ€æœ¯æŒ‡æ ‡è¯„åˆ†
    indicator_score = 0
    if macd_signal == 'bullish':
        indicator_score += 7
    if 30 < rsi_value < 70:  # RSIåœ¨åˆç†åŒºé—´
        indicator_score += 7
    if kdj_signal == 'bullish':
        indicator_score += 6
    
    # 4. çªç ´ä¿¡å·è¯„åˆ†ï¼ˆ0-10åˆ†ï¼‰
    # æ£€æŸ¥æ˜¯å¦ç«™ä¸Šå‡çº¿
    current_price = price_data['close'].iloc[-1]
    ma20_current = ma20.iloc[-1]
    ma60_current = ma60.iloc[-1]
    
    breakthrough_score = 0
    if current_price > ma20_current and ma20_current > ma60_current:
        breakthrough_score = 10
    elif current_price > ma20_current:
        breakthrough_score = 7
    elif current_price > ma60_current:
        breakthrough_score = 5
    
    # è®¾è®¡åŸç†ï¼šæŠ€æœ¯é¢è¯„åˆ†é‡‡ç”¨ç´¯åŠ æ–¹å¼
    # åŸå› ï¼šå¤šä¸ªæŠ€æœ¯æŒ‡æ ‡ç»¼åˆè¯„åˆ†ï¼Œç´¯åŠ åæ˜ æ•´ä½“æŠ€æœ¯é¢å¼ºåº¦
    # è¯„åˆ†ç»´åº¦ï¼šè¶‹åŠ¿å¼ºåº¦ã€æˆäº¤é‡ã€æŠ€æœ¯æŒ‡æ ‡ã€çªç ´ä¿¡å·
    # ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼šå•ä¸€æŒ‡æ ‡å¯èƒ½è¯¯åˆ¤ï¼Œå¤šæŒ‡æ ‡ç»¼åˆæ›´å‡†ç¡®
    score = trend_score + volume_score + indicator_score + breakthrough_score
    
    # è®¾è®¡åŸç†ï¼šå¾—åˆ†é™åˆ¶åœ¨0-100åˆ†
    # åŸå› ï¼šç¡®ä¿è¯„åˆ†åœ¨åˆç†èŒƒå›´å†…ï¼Œä¾¿äºåç»­æ¯”è¾ƒå’Œæ’åº
    # å®ç°æ–¹å¼ï¼šä½¿ç”¨minå’Œmaxå‡½æ•°é™åˆ¶èŒƒå›´
    return min(100, max(0, score))
```

### è¾…åŠ©å‡½æ•°å®ç°

```python
def calculate_macd_signal(price_data: pd.DataFrame) -> str:
    """è®¡ç®—MACDä¿¡å·"""
    ema12 = price_data['close'].ewm(span=12, adjust=False).mean()
    ema26 = price_data['close'].ewm(span=26, adjust=False).mean()
    macd = ema12 - ema26
    signal = macd.ewm(span=9, adjust=False).mean()
    
    if macd.iloc[-1] > signal.iloc[-1] and macd.iloc[-2] <= signal.iloc[-2]:
        return 'bullish'  # é‡‘å‰
    elif macd.iloc[-1] < signal.iloc[-1] and macd.iloc[-2] >= signal.iloc[-2]:
        return 'bearish'  # æ­»å‰
    else:
        return 'neutral'

def calculate_rsi(price_data: pd.DataFrame, period: int = 14) -> float:
    """è®¡ç®—RSIæŒ‡æ ‡"""
    delta = price_data['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    return rsi.iloc[-1]

def calculate_kdj_signal(price_data: pd.DataFrame) -> str:
    """è®¡ç®—KDJä¿¡å·"""
    low_min = price_data['low'].rolling(9).min()
    high_max = price_data['high'].rolling(9).max()
    rsv = (price_data['close'] - low_min) / (high_max - low_min) * 100
    k = rsv.ewm(com=2).mean()
    d = k.ewm(com=2).mean()
    j = 3 * k - 2 * d
    
    if k.iloc[-1] > d.iloc[-1] and k.iloc[-2] <= d.iloc[-2]:
        return 'bullish'  # Kçº¿ä¸Šç©¿Dçº¿
    elif k.iloc[-1] < d.iloc[-1] and k.iloc[-2] >= d.iloc[-2]:
        return 'bearish'  # Kçº¿ä¸‹ç©¿Dçº¿
    else:
        return 'neutral'
```

<h2 id="section-5-3-2">ğŸ’° 5.3.2 èµ„é‡‘é¢è¯„åˆ†</h2>

èµ„é‡‘é¢è¯„åˆ†é€šè¿‡åˆ†æä¸»åŠ›èµ„é‡‘ã€åŒ—å‘èµ„é‡‘ã€é¾™è™æ¦œã€æ¢æ‰‹ç‡ç­‰ï¼Œè¯„ä¼°è‚¡ç¥¨çš„èµ„é‡‘è®¤å¯åº¦ã€‚

### è¯„åˆ†å› å­

èµ„é‡‘é¢è¯„åˆ†åŒ…æ‹¬ä»¥ä¸‹å› å­ï¼š

1. **ä¸»åŠ›èµ„é‡‘**ï¼ˆ40%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šAKShareã€JQData
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºä¸»åŠ›å‡€æµå…¥ã€ä¸»åŠ›å æ¯”ã€èµ„é‡‘æŒç»­æ€§

2. **åŒ—å‘èµ„é‡‘**ï¼ˆ30%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šAKShareã€JQData
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºåŒ—å‘æŒä»“ã€åŒ—å‘å¢æŒã€åŒ—å‘å æ¯”

3. **é¾™è™æ¦œ**ï¼ˆ20%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šAKShare
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºä¸Šæ¦œæ¬¡æ•°ã€å‡€ä¹°å…¥é¢ã€æœºæ„å¸­ä½

4. **æ¢æ‰‹ç‡**ï¼ˆ10%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€AKShare
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºæ¢æ‰‹ç‡æ°´å¹³ã€æ¢æ‰‹ç‡å˜åŒ–

### è¯„åˆ†æ–¹æ³•å®ç°

```python
def score_capital_dimension(
    stock_code: str,
    main_fund_data: Dict,
    northbound_data: Dict,
    lhb_data: Dict,
    turnover_data: Dict
) -> float:
    """
    èµ„é‡‘é¢è¯„åˆ†
    
    Args:
        stock_code: è‚¡ç¥¨ä»£ç 
        main_fund_data: ä¸»åŠ›èµ„é‡‘æ•°æ®
        northbound_data: åŒ—å‘èµ„é‡‘æ•°æ®
        lhb_data: é¾™è™æ¦œæ•°æ®
        turnover_data: æ¢æ‰‹ç‡æ•°æ®
    
    Returns:
        èµ„é‡‘é¢è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
    """
    score = 0.0
    
    # 1. ä¸»åŠ›èµ„é‡‘è¯„åˆ†ï¼ˆ0-40åˆ†ï¼‰
    main_fund_inflow = main_fund_data.get('net_inflow', 0)  # å‡€æµå…¥ï¼ˆä¸‡å…ƒï¼‰
    main_fund_ratio = main_fund_data.get('main_ratio', 0)  # ä¸»åŠ›å æ¯”
    consecutive_days = main_fund_data.get('consecutive_inflow_days', 0)  # è¿ç»­æµå…¥å¤©æ•°
    
    # è®¾è®¡åŸç†ï¼šä¸»åŠ›èµ„é‡‘è¯„åˆ†é‡‡ç”¨åˆ†æ®µè¯„åˆ†
    # åŸå› ï¼šä¸åŒèµ„é‡‘æµå…¥æ°´å¹³å¯¹åº”ä¸åŒçš„è¯„åˆ†ï¼Œéœ€è¦åˆ†æ®µå¤„ç†
    # è¯„åˆ†ç»´åº¦ï¼šå‡€æµå…¥é‡‘é¢ã€ä¸»åŠ›å æ¯”ã€è¿ç»­æµå…¥å¤©æ•°
    # ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼šç»¼åˆè€ƒè™‘å¤šä¸ªç»´åº¦ï¼Œæ›´å‡†ç¡®åæ˜ ä¸»åŠ›èµ„é‡‘è®¤å¯åº¦
    # è¯„åˆ†é€»è¾‘ï¼š
    # - ä¼˜ç§€ï¼ˆ40åˆ†ï¼‰ï¼šå¤§é¢æµå…¥ + é«˜å æ¯” + æŒç»­æµå…¥
    # - è‰¯å¥½ï¼ˆ35åˆ†ï¼‰ï¼šä¸­ç­‰æµå…¥ + ä¸­ç­‰å æ¯” + æŒç»­æµå…¥
    # - ä¸€èˆ¬ï¼ˆ30åˆ†ï¼‰ï¼šå°é¢æµå…¥ + ä½å æ¯”
    # - è¾ƒå·®ï¼ˆ20åˆ†ï¼‰ï¼šå°å¹…æµå‡º
    # - å¾ˆå·®ï¼ˆ10-0åˆ†ï¼‰ï¼šå¤§å¹…æµå‡º
    if main_fund_inflow > 10000 and main_fund_ratio > 0.3 and consecutive_days >= 3:
        main_fund_score = 40
    elif main_fund_inflow > 5000 and main_fund_ratio > 0.2 and consecutive_days >= 2:
        main_fund_score = 35
    elif main_fund_inflow > 0 and main_fund_ratio > 0.1:
        main_fund_score = 30
    elif main_fund_inflow > -5000:
        main_fund_score = 20
    else:
        # è®¾è®¡åŸç†ï¼šçº¿æ€§è¯„åˆ†
        # åŸå› ï¼šå¤§å¹…æµå‡ºæ—¶ï¼Œæµå‡ºè¶Šå¤šå¾—åˆ†è¶Šä½
        # å…¬å¼ï¼šå¾—åˆ† = 10 + å‡€æµå…¥/1000ï¼Œæœ€ä½0åˆ†
        main_fund_score = max(0, 10 + main_fund_inflow / 1000)
    
    # 2. åŒ—å‘èµ„é‡‘è¯„åˆ†ï¼ˆ0-30åˆ†ï¼‰
    northbound_position = northbound_data.get('position', 0)  # æŒä»“å¸‚å€¼ï¼ˆä¸‡å…ƒï¼‰
    northbound_change = northbound_data.get('change_pct', 0)  # å¢æŒå¹…åº¦ï¼ˆ%ï¼‰
    northbound_ratio = northbound_data.get('ratio', 0)  # å æµé€šç›˜æ¯”ä¾‹
    
    # åŒ—å‘èµ„é‡‘è¯„åˆ†
    if northbound_position > 50000 and northbound_change > 5 and northbound_ratio > 0.05:
        northbound_score = 30
    elif northbound_position > 20000 and northbound_change > 2 and northbound_ratio > 0.02:
        northbound_score = 25
    elif northbound_position > 0 and northbound_change > 0:
        northbound_score = 20
    elif northbound_position > 0:
        northbound_score = 15
    else:
        northbound_score = 10
    
    # 3. é¾™è™æ¦œè¯„åˆ†ï¼ˆ0-20åˆ†ï¼‰
    lhb_count = lhb_data.get('count', 0)  # ä¸Šæ¦œæ¬¡æ•°ï¼ˆè¿‘20æ—¥ï¼‰
    lhb_net_buy = lhb_data.get('net_buy', 0)  # å‡€ä¹°å…¥é¢ï¼ˆä¸‡å…ƒï¼‰
    institution_count = lhb_data.get('institution_count', 0)  # æœºæ„å¸­ä½æ¬¡æ•°
    
    # é¾™è™æ¦œè¯„åˆ†
    if lhb_count >= 3 and lhb_net_buy > 5000 and institution_count >= 1:
        lhb_score = 20
    elif lhb_count >= 2 and lhb_net_buy > 0:
        lhb_score = 15
    elif lhb_count >= 1:
        lhb_score = 10
    else:
        lhb_score = 5
    
    # 4. æ¢æ‰‹ç‡è¯„åˆ†ï¼ˆ0-10åˆ†ï¼‰
    turnover_rate = turnover_data.get('turnover_rate', 0)  # æ¢æ‰‹ç‡ï¼ˆ%ï¼‰
    turnover_change = turnover_data.get('turnover_change', 0)  # æ¢æ‰‹ç‡å˜åŒ–ï¼ˆ%ï¼‰
    
    # æ¢æ‰‹ç‡è¯„åˆ†ï¼ˆé€‚åº¦æ´»è·ƒä¸ºä½³ï¼‰
    if 3 <= turnover_rate <= 10 and turnover_change > 0:
        turnover_score = 10
    elif 2 <= turnover_rate <= 15:
        turnover_score = 8
    elif turnover_rate > 0:
        turnover_score = 5
    else:
        turnover_score = 0
    
    score = main_fund_score + northbound_score + lhb_score + turnover_score
    return min(100, max(0, score))
```

<h2 id="section-5-3-3">ğŸ’¼ 5.3.3 åŸºæœ¬é¢è¯„åˆ†</h2>

åŸºæœ¬é¢è¯„åˆ†é€šè¿‡åˆ†æç›ˆåˆ©èƒ½åŠ›ã€æˆé•¿æ€§ã€ä¼°å€¼æ°´å¹³ã€è´¢åŠ¡å¥åº·ç­‰ï¼Œè¯„ä¼°è‚¡ç¥¨çš„åŸºæœ¬é¢è´¨é‡ã€‚

### è¯„åˆ†å› å­

åŸºæœ¬é¢è¯„åˆ†åŒ…æ‹¬ä»¥ä¸‹å› å­ï¼š

1. **ç›ˆåˆ©èƒ½åŠ›**ï¼ˆ35%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€Wind
   - æ›´æ–°é¢‘ç‡ï¼šå­£åº¦
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºROEã€ROAã€å‡€åˆ©æ¶¦ç‡

2. **æˆé•¿æ€§**ï¼ˆ35%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€Wind
   - æ›´æ–°é¢‘ç‡ï¼šå­£åº¦
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºè¥æ”¶å¢é€Ÿã€å‡€åˆ©æ¶¦å¢é€Ÿã€è¥æ”¶è´¨é‡

3. **ä¼°å€¼æ°´å¹³**ï¼ˆ20%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€Wind
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºPEã€PBã€PEG

4. **è´¢åŠ¡å¥åº·**ï¼ˆ10%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šJQDataã€Wind
   - æ›´æ–°é¢‘ç‡ï¼šå­£åº¦
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºè´Ÿå€ºç‡ã€ç°é‡‘æµã€èµ„äº§è´¨é‡

### è¯„åˆ†æ–¹æ³•å®ç°

```python
def score_fundamental_dimension(
    stock_code: str,
    financial_data: Dict,
    valuation_data: Dict
) -> float:
    """
    åŸºæœ¬é¢è¯„åˆ†
    
    Args:
        stock_code: è‚¡ç¥¨ä»£ç 
        financial_data: è´¢åŠ¡æ•°æ®
        valuation_data: ä¼°å€¼æ•°æ®
    
    Returns:
        åŸºæœ¬é¢è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
    """
    score = 0.0
    
    # 1. ç›ˆåˆ©èƒ½åŠ›è¯„åˆ†ï¼ˆ0-35åˆ†ï¼‰
    roe = financial_data.get('roe', 0)  # ROEï¼ˆ%ï¼‰
    roa = financial_data.get('roa', 0)  # ROAï¼ˆ%ï¼‰
    net_profit_margin = financial_data.get('net_profit_margin', 0)  # å‡€åˆ©æ¶¦ç‡ï¼ˆ%ï¼‰
    
    # ç›ˆåˆ©èƒ½åŠ›è¯„åˆ†
    profit_score = 0
    if roe > 20:
        profit_score += 12
    elif roe > 15:
        profit_score += 10
    elif roe > 10:
        profit_score += 8
    else:
        profit_score += max(0, roe / 10 * 8)
    
    if roa > 10:
        profit_score += 12
    elif roa > 7:
        profit_score += 10
    elif roa > 5:
        profit_score += 8
    else:
        profit_score += max(0, roa / 5 * 8)
    
    if net_profit_margin > 20:
        profit_score += 11
    elif net_profit_margin > 15:
        profit_score += 9
    elif net_profit_margin > 10:
        profit_score += 7
    else:
        profit_score += max(0, net_profit_margin / 10 * 7)
    
    profit_score = min(35, profit_score)
    
    # 2. æˆé•¿æ€§è¯„åˆ†ï¼ˆ0-35åˆ†ï¼‰
    revenue_growth = financial_data.get('revenue_growth', 0)  # è¥æ”¶å¢é€Ÿï¼ˆ%ï¼‰
    profit_growth = financial_data.get('profit_growth', 0)  # å‡€åˆ©æ¶¦å¢é€Ÿï¼ˆ%ï¼‰
    revenue_quality = financial_data.get('revenue_quality', 0)  # è¥æ”¶è´¨é‡ï¼ˆ0-1ï¼‰
    
    # æˆé•¿æ€§è¯„åˆ†
    growth_score = 0
    if revenue_growth > 30:
        growth_score += 12
    elif revenue_growth > 20:
        growth_score += 10
    elif revenue_growth > 10:
        growth_score += 8
    else:
        growth_score += max(0, revenue_growth / 10 * 8)
    
    if profit_growth > 50:
        growth_score += 12
    elif profit_growth > 30:
        growth_score += 10
    elif profit_growth > 20:
        growth_score += 8
    else:
        growth_score += max(0, profit_growth / 20 * 8)
    
    growth_score += revenue_quality * 11
    growth_score = min(35, growth_score)
    
    # 3. ä¼°å€¼æ°´å¹³è¯„åˆ†ï¼ˆ0-20åˆ†ï¼‰
    pe = valuation_data.get('pe', 0)  # PE
    pb = valuation_data.get('pb', 0)  # PB
    peg = valuation_data.get('peg', 0)  # PEG
    
    # ä¼°å€¼æ°´å¹³è¯„åˆ†ï¼ˆä¼°å€¼è¶Šä½ï¼Œè¯„åˆ†è¶Šé«˜ï¼‰
    valuation_score = 0
    if 10 <= pe <= 25:
        valuation_score += 7
    elif 5 <= pe < 10 or 25 < pe <= 40:
        valuation_score += 5
    elif pe < 5 or 40 < pe <= 60:
        valuation_score += 3
    else:
        valuation_score += max(0, 7 - abs(pe - 20) / 10)
    
    if 1 <= pb <= 3:
        valuation_score += 7
    elif 0.5 <= pb < 1 or 3 < pb <= 5:
        valuation_score += 5
    else:
        valuation_score += max(0, 7 - abs(pb - 2) / 0.5)
    
    if 0.5 <= peg <= 1.5:
        valuation_score += 6
    elif 0.3 <= peg < 0.5 or 1.5 < peg <= 2:
        valuation_score += 4
    else:
        valuation_score += max(0, 6 - abs(peg - 1) / 0.5)
    
    valuation_score = min(20, valuation_score)
    
    # 4. è´¢åŠ¡å¥åº·è¯„åˆ†ï¼ˆ0-10åˆ†ï¼‰
    debt_ratio = financial_data.get('debt_ratio', 0)  # è´Ÿå€ºç‡ï¼ˆ%ï¼‰
    cash_flow = financial_data.get('cash_flow', 0)  # ç»è¥ç°é‡‘æµï¼ˆä¸‡å…ƒï¼‰
    asset_quality = financial_data.get('asset_quality', 0)  # èµ„äº§è´¨é‡ï¼ˆ0-1ï¼‰
    
    # è´¢åŠ¡å¥åº·è¯„åˆ†
    health_score = 0
    if debt_ratio < 30:
        health_score += 4
    elif debt_ratio < 50:
        health_score += 3
    elif debt_ratio < 70:
        health_score += 2
    else:
        health_score += max(0, 4 - (debt_ratio - 30) / 10)
    
    if cash_flow > 0:
        health_score += 3
    elif cash_flow > -10000:
        health_score += 2
    else:
        health_score += 1
    
    health_score += asset_quality * 3
    health_score = min(10, health_score)
    
    score = profit_score + growth_score + valuation_score + health_score
    return min(100, max(0, score))
```

<h2 id="section-5-3-4">ğŸ˜Š 5.3.4 æƒ…ç»ªé¢è¯„åˆ†</h2>

æƒ…ç»ªé¢è¯„åˆ†é€šè¿‡åˆ†ææ¶¨è·Œåœã€é¾™è™æ¦œã€å¸‚åœºæƒ…ç»ªç­‰ï¼Œè¯„ä¼°è‚¡ç¥¨çš„å¸‚åœºæƒ…ç»ªã€‚

### è¯„åˆ†å› å­

æƒ…ç»ªé¢è¯„åˆ†åŒ…æ‹¬ä»¥ä¸‹å› å­ï¼š

1. **æ¶¨è·Œåœ**ï¼ˆ50%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šAKShareã€JQData
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºæ¶¨åœæ¬¡æ•°ã€è·Œåœæ¬¡æ•°

2. **é¾™è™æ¦œ**ï¼ˆ30%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šAKShare
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºä¸Šæ¦œæ¬¡æ•°ã€æ¸¸èµ„å‚ä¸åº¦

3. **å¸‚åœºæƒ…ç»ª**ï¼ˆ20%æƒé‡ï¼‰
   - æ•°æ®æ¥æºï¼šå¸‚åœºæ•°æ®
   - æ›´æ–°é¢‘ç‡ï¼šæ¯æ—¥
   - è¯„åˆ†æ–¹æ³•ï¼šåŸºäºå¸‚åœºçƒ­åº¦ã€èµ„é‡‘æƒ…ç»ª

### è¯„åˆ†æ–¹æ³•å®ç°

```python
def score_sentiment_dimension(
    stock_code: str,
    limit_data: Dict,
    lhb_data: Dict,
    market_sentiment: Dict
) -> float:
    """
    æƒ…ç»ªé¢è¯„åˆ†
    
    Args:
        stock_code: è‚¡ç¥¨ä»£ç 
        limit_data: æ¶¨è·Œåœæ•°æ®
        lhb_data: é¾™è™æ¦œæ•°æ®
        market_sentiment: å¸‚åœºæƒ…ç»ªæ•°æ®
    
    Returns:
        æƒ…ç»ªé¢è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
    """
    score = 0.0
    
    # 1. æ¶¨è·Œåœè¯„åˆ†ï¼ˆ0-50åˆ†ï¼‰
    limit_up_count = limit_data.get('limit_up_count', 0)  # æ¶¨åœæ¬¡æ•°ï¼ˆè¿‘20æ—¥ï¼‰
    limit_down_count = limit_data.get('limit_down_count', 0)  # è·Œåœæ¬¡æ•°ï¼ˆè¿‘20æ—¥ï¼‰
    
    # æ¶¨è·Œåœè¯„åˆ†
    if limit_up_count >= 3 and limit_down_count == 0:
        limit_score = 50
    elif limit_up_count >= 2 and limit_down_count == 0:
        limit_score = 40
    elif limit_up_count >= 1 and limit_down_count == 0:
        limit_score = 30
    elif limit_up_count > limit_down_count:
        limit_score = 20
    elif limit_down_count == 0:
        limit_score = 15
    else:
        limit_score = max(0, 10 - limit_down_count * 5)
    
    # 2. é¾™è™æ¦œè¯„åˆ†ï¼ˆ0-30åˆ†ï¼‰
    lhb_count = lhb_data.get('count', 0)  # ä¸Šæ¦œæ¬¡æ•°ï¼ˆè¿‘20æ—¥ï¼‰
    speculator_ratio = lhb_data.get('speculator_ratio', 0)  # æ¸¸èµ„å‚ä¸åº¦ï¼ˆ0-1ï¼‰
    
    # é¾™è™æ¦œè¯„åˆ†
    if lhb_count >= 3 and speculator_ratio > 0.5:
        lhb_score = 30
    elif lhb_count >= 2 and speculator_ratio > 0.3:
        lhb_score = 25
    elif lhb_count >= 1:
        lhb_score = 20
    else:
        lhb_score = 10
    
    # 3. å¸‚åœºæƒ…ç»ªè¯„åˆ†ï¼ˆ0-20åˆ†ï¼‰
    market_heat = market_sentiment.get('heat', 0)  # å¸‚åœºçƒ­åº¦ï¼ˆ0-1ï¼‰
    capital_sentiment = market_sentiment.get('capital_sentiment', 0)  # èµ„é‡‘æƒ…ç»ªï¼ˆ0-1ï¼‰
    
    # å¸‚åœºæƒ…ç»ªè¯„åˆ†
    sentiment_score = (market_heat * 0.6 + capital_sentiment * 0.4) * 20
    
    score = limit_score + lhb_score + sentiment_score
    return min(100, max(0, score))
```

<h2 id="section-5-3-5">ğŸ”¢ 5.3.5 ç»¼åˆè¯„åˆ†è®¡ç®—</h2>

ç»¼åˆè¯„åˆ†é€šè¿‡åŠ æƒå¹³å‡è®¡ç®—å„ç»´åº¦è¯„åˆ†ï¼Œå¹¶ç»“åˆä¸»çº¿çƒ­åº¦ï¼Œå¾—åˆ°æœ€ç»ˆçš„è‚¡ç¥¨è¯„åˆ†ã€‚

### æƒé‡é…ç½®

é»˜è®¤æƒé‡é…ç½®å¦‚ä¸‹ï¼š

```python
DEFAULT_WEIGHTS = {
    'technical': 0.30,   # æŠ€æœ¯é¢æƒé‡ï¼š30%
    'capital': 0.30,     # èµ„é‡‘é¢æƒé‡ï¼š30%
    'fundamental': 0.30, # åŸºæœ¬é¢æƒé‡ï¼š30%
    'sentiment': 0.10    # æƒ…ç»ªé¢æƒé‡ï¼š10%
}
```

### ç»¼åˆè¯„åˆ†è®¡ç®—å®ç°

```python
def calculate_composite_score(
    technical_score: float,
    capital_score: float,
    fundamental_score: float,
    sentiment_score: float,
    mainline_heat: float = 0.0,
    weights: Dict = None
) -> float:
    """
    è®¡ç®—ç»¼åˆè¯„åˆ†
    
    Args:
        technical_score: æŠ€æœ¯é¢è¯„åˆ†
        capital_score: èµ„é‡‘é¢è¯„åˆ†
        fundamental_score: åŸºæœ¬é¢è¯„åˆ†
        sentiment_score: æƒ…ç»ªé¢è¯„åˆ†
        mainline_heat: ä¸»çº¿çƒ­åº¦ï¼ˆ0-1ï¼Œå¯é€‰ï¼‰
        weights: å„ç»´åº¦æƒé‡å­—å…¸ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨DEFAULT_WEIGHTSï¼‰
    
    Returns:
        ç»¼åˆè¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
    """
    if weights is None:
        weights = DEFAULT_WEIGHTS
    
    # ç¬¬ä¸€æ­¥ï¼šè®¡ç®—ä¸ªè‚¡å› å­å¾—åˆ†
    stock_factor = (
        technical_score * weights['technical'] +
        capital_score * weights['capital'] +
        fundamental_score * weights['fundamental'] +
        sentiment_score * weights['sentiment']
    )
    
    # ç¬¬äºŒæ­¥ï¼šç»“åˆä¸»çº¿çƒ­åº¦ï¼ˆå¦‚æœæä¾›ï¼‰
    if mainline_heat > 0:
        # ä¸»çº¿çƒ­åº¦æƒé‡15%ï¼Œä¸ªè‚¡å› å­æƒé‡85%
        composite_score = (
            mainline_heat * 100 * 0.15 +  # ä¸»çº¿çƒ­åº¦è½¬æ¢ä¸º0-100åˆ†
            stock_factor * 0.85
        )
    else:
        composite_score = stock_factor
    
    return min(100, max(0, composite_score))
```

### å®Œæ•´å®ç°ç¤ºä¾‹

```python
class StockScorer:
    """è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿ"""
    
    def __init__(self, weights: Dict = None):
        self.weights = weights or DEFAULT_WEIGHTS
    
    def score_stock(
        self,
        stock_code: str,
        price_data: pd.DataFrame,
        volume_data: pd.DataFrame,
        main_fund_data: Dict,
        northbound_data: Dict,
        lhb_data: Dict,
        turnover_data: Dict,
        financial_data: Dict,
        valuation_data: Dict,
        limit_data: Dict,
        market_sentiment: Dict,
        mainline_heat: float = 0.0,
        date: str = None
    ) -> Dict:
        """
        å¯¹è‚¡ç¥¨è¿›è¡Œç»¼åˆè¯„åˆ†
        
        Returns:
            è¯„åˆ†ç»“æœå­—å…¸
        """
        # 1. è®¡ç®—å„ç»´åº¦è¯„åˆ†
        technical_score = score_technical_dimension(
            stock_code, price_data, volume_data, date
        )
        
        capital_score = score_capital_dimension(
            stock_code, main_fund_data, northbound_data, lhb_data, turnover_data
        )
        
        fundamental_score = score_fundamental_dimension(
            stock_code, financial_data, valuation_data
        )
        
        sentiment_score = score_sentiment_dimension(
            stock_code, limit_data, lhb_data, market_sentiment
        )
        
        # 2. è®¡ç®—ç»¼åˆè¯„åˆ†
        composite_score = calculate_composite_score(
            technical_score,
            capital_score,
            fundamental_score,
            sentiment_score,
            mainline_heat,
            self.weights
        )
        
        return {
            'stock_code': stock_code,
            'scores': {
                'technical': technical_score,
                'capital': capital_score,
                'fundamental': fundamental_score,
                'sentiment': sentiment_score
            },
            'composite_score': composite_score,
            'mainline_heat': mainline_heat,
            'weights': self.weights,
            'timestamp': datetime.now().isoformat()
        }
```

<h2 id="section-5-3-6">ğŸ“Š 5.3.6 è¯„åˆ†æ’åº</h2>

è¯„åˆ†æ’åºæ ¹æ®ç»¼åˆå¾—åˆ†å¯¹å€™é€‰è‚¡ç¥¨è¿›è¡Œæ’åºï¼Œæ”¯æŒå¤šç»´åº¦æ’åºã€‚

### æ’åºæ–¹æ³•

#### 1. æŒ‰ç»¼åˆå¾—åˆ†æ’åº

```python
def sort_by_composite_score(stocks: List[CandidateStock]) -> List[CandidateStock]:
    """
    æŒ‰ç»¼åˆå¾—åˆ†æ’åº
    
    Args:
        stocks: å€™é€‰è‚¡ç¥¨åˆ—è¡¨
    
    Returns:
        æ’åºåçš„è‚¡ç¥¨åˆ—è¡¨
    """
    return sorted(stocks, key=lambda x: x.composite_score, reverse=True)
```

#### 2. æŒ‰å› å­å¾—åˆ†æ’åº

```python
def sort_by_factor_score(
    stocks: List[CandidateStock],
    factor: str = 'technical'
) -> List[CandidateStock]:
    """
    æŒ‰å› å­å¾—åˆ†æ’åº
    
    Args:
        stocks: å€™é€‰è‚¡ç¥¨åˆ—è¡¨
        factor: å› å­åç§°ï¼ˆtechnical/capital/fundamental/sentimentï¼‰
    
    Returns:
        æ’åºåçš„è‚¡ç¥¨åˆ—è¡¨
    """
    factor_map = {
        'technical': 'technical_score',
        'capital': 'capital_score',
        'fundamental': 'fundamental_score',
        'sentiment': 'sentiment_score'
    }
    
    factor_key = factor_map.get(factor, 'composite_score')
    return sorted(stocks, key=lambda x: getattr(x, factor_key, 0), reverse=True)
```

#### 3. å¤šç»´åº¦æ’åº

```python
def sort_by_multiple_factors(
    stocks: List[CandidateStock],
    factors: List[Tuple[str, bool]] = None
) -> List[CandidateStock]:
    """
    å¤šç»´åº¦æ’åº
    
    Args:
        stocks: å€™é€‰è‚¡ç¥¨åˆ—è¡¨
        factors: æ’åºå› å­åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ ä¸º(å› å­åç§°, æ˜¯å¦é™åº)
                ä¾‹å¦‚ï¼š[('composite_score', True), ('technical_score', True), ('fundamental_score', False)]
    
    Returns:
        æ’åºåçš„è‚¡ç¥¨åˆ—è¡¨
    """
    if factors is None:
        factors = [('composite_score', True)]
    
    def sort_key(stock):
        key_values = []
        for factor, reverse in factors:
            if factor == 'composite_score':
                value = stock.composite_score
            elif factor == 'technical_score':
                value = stock.technical_score
            elif factor == 'capital_score':
                value = stock.capital_score
            elif factor == 'fundamental_score':
                value = stock.fundamental_score
            elif factor == 'sentiment_score':
                value = stock.sentiment_score
            else:
                value = 0
            
            # å¦‚æœé™åºï¼Œå–è´Ÿå€¼
            if reverse:
                key_values.append(-value)
            else:
                key_values.append(value)
        
        return tuple(key_values)
    
    return sorted(stocks, key=sort_key)
```

### åº”ç”¨åœºæ™¯

è¯„åˆ†æ’åºç»“æœç”¨äºï¼š

1. **å€™é€‰æ± æ’åº**ï¼šæŒ‰ç»¼åˆå¾—åˆ†æ’åºï¼Œä¼˜å…ˆé€‰æ‹©é«˜åˆ†è‚¡ç¥¨
2. **ç­–ç•¥é€‰è‚¡**ï¼šæ ¹æ®ç­–ç•¥éœ€æ±‚é€‰æ‹©ç‰¹å®šå› å­æ’åº
3. **é£é™©æ§åˆ¶**ï¼šç»“åˆå¤šç»´åº¦æ’åºï¼Œé¿å…å•ä¸€ç»´åº¦åå·®

## ğŸ”— ç›¸å…³ç« èŠ‚

- **5.1 è‚¡ç¥¨æ± ç®¡ç†**ï¼šäº†è§£è‚¡ç¥¨æ± ç®¡ç†ï¼Œä¸ºè‚¡ç¥¨è¯„åˆ†æä¾›è‚¡ç¥¨æ± 
- **5.2 ç­›é€‰è§„åˆ™**ï¼šäº†è§£ç­›é€‰è§„åˆ™ï¼Œç­›é€‰åçš„è‚¡ç¥¨ç”¨äºè¯„åˆ†
- **ç¬¬6ç« ï¼šå› å­åº“**ï¼šäº†è§£å› å­åº“ï¼Œä¸ºè‚¡ç¥¨è¯„åˆ†æä¾›å› å­æ•°æ®
- **ç¬¬7ç« ï¼šç­–ç•¥å¼€å‘**ï¼šäº†è§£ç­–ç•¥å¼€å‘ï¼Œè‚¡ç¥¨è¯„åˆ†ç»“æœç”¨äºç­–ç•¥é€‰è‚¡
- **ç¬¬10ç« ï¼šå¼€å‘æŒ‡å—**ï¼šäº†è§£è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿçš„å¼€å‘è§„èŒƒ

## ğŸ’¡ å…³é”®è¦ç‚¹

1. **å¤šç»´åº¦è¯„åˆ†**ï¼šé€šè¿‡æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€åŸºæœ¬é¢ã€æƒ…ç»ªé¢å››ä¸ªç»´åº¦å…¨é¢è¯„ä¼°è‚¡ç¥¨è´¨é‡
2. **æƒé‡é…ç½®**ï¼šæ”¯æŒæ ¹æ®å¸‚åœºç¯å¢ƒåŠ¨æ€è°ƒæ•´å„ç»´åº¦æƒé‡
3. **ä¸»çº¿èåˆ**ï¼šç»“åˆä¸»çº¿çƒ­åº¦ï¼Œæå‡ä¸»çº¿ç›¸å…³è‚¡ç¥¨çš„è¯„åˆ†
4. **è¯„åˆ†æ’åº**ï¼šæ”¯æŒæŒ‰ç»¼åˆå¾—åˆ†ã€å› å­å¾—åˆ†ã€å¤šç»´åº¦æ’åº

## ğŸ”® æ€»ç»“ä¸å±•æœ›

<div class="summary-outlook">
  <h3>æœ¬èŠ‚å›é¡¾</h3>
  <p>æœ¬èŠ‚ç³»ç»Ÿä»‹ç»äº†å€™é€‰æ± æ„å»ºæ¨¡å—çš„è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿï¼Œé€šè¿‡æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€åŸºæœ¬é¢ã€æƒ…ç»ªé¢å››ä¸ªç»´åº¦å¯¹å€™é€‰è‚¡ç¥¨è¿›è¡Œå¤šå› å­è¯„åˆ†ï¼Œå¹¶è®¡ç®—ç»¼åˆè¯„åˆ†ã€‚é€šè¿‡ç†è§£å„ç»´åº¦è¯„åˆ†æ–¹æ³•ã€ç»¼åˆè¯„åˆ†è®¡ç®—å’Œè¯„åˆ†æ’åºæ–¹æ³•ï¼Œå¸®åŠ©å¼€å‘è€…æŒæ¡å¦‚ä½•æ„å»ºå…¨é¢çš„è‚¡ç¥¨è¯„åˆ†ä½“ç³»ï¼Œä¸ºå€™é€‰æ± æ’åºå’Œç­›é€‰æä¾›å‡†ç¡®ä¾æ®ã€‚</p>
  
  <h3>ä¸‹èŠ‚é¢„å‘Š</h3>
  <p>æŒæ¡äº†è‚¡ç¥¨è¯„åˆ†ç³»ç»Ÿåï¼Œä¸‹ä¸€èŠ‚å°†ä»‹ç»MCPå·¥å…·é›†æˆï¼ŒåŒ…æ‹¬çŸ¥è¯†åº“æŸ¥è¯¢ã€æ•°æ®æ”¶é›†å·¥å…·ç­‰ã€‚é€šè¿‡ç†è§£MCPå·¥å…·åœ¨å€™é€‰æ± æ„å»ºä¸­çš„åº”ç”¨ï¼Œå¸®åŠ©å¼€å‘è€…æŒæ¡å¦‚ä½•ä½¿ç”¨MCPå·¥å…·æå‡å€™é€‰æ± æ„å»ºæ•ˆç‡ã€‚</p>
  
  <a href="/ashare-book6/005_Chapter5_Candidate_Pool/5.4_MCP_Tool_Integration_CN" class="next-section">
    ç»§ç»­å­¦ä¹ ï¼š5.4 MCPå·¥å…·é›†æˆ â†’
  </a>
</div>

> **é€‚ç”¨ç‰ˆæœ¬**: v1.0.0+  
> **æœ€åæ›´æ–°**: 2025-12-12

